{% extends "base_authentication.html" %}

{% load i18n crispy_forms_tags %}

{% block title %}{% trans "Definir nova senha" %} | Propzy{% endblock %}

{% block auth_content %}
<h1 class="h3 mb-3" style="color: #13112F; font-weight: 600;">{% trans "Definir nova senha" %}</h1>
{% if token_fail %}
    <div class="alert alert-danger" role="alert">
        {% trans "O link de redefinição é inválido ou já foi utilizado." %}
    </div>
    <div class="text-center">
        <a class="btn btn-primary" href="{% url 'account_reset_password' %}">{% trans "Solicitar novo link" %}</a>
    </div>
{% else %}
    <form method="post" novalidate>
        {% csrf_token %}
        {% if form.non_field_errors %}
        <div class="alert alert-danger" role="alert" style="line-height: 1.6;">
            <ul class="mb-0 ps-3" style="list-style-type: none; padding-left: 0;">
                {% for error in form.non_field_errors %}
                <li style="margin-bottom: 0.25rem;">
                    <i class="fa-solid fa-circle-exclamation" style="margin-right: 0.5rem;"></i>{{ error }}
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        <div class="mb-3">
            <label for="{{ form.password1.id_for_label }}" class="form-label">{{ form.password1.label }}</label>
            <div class="password-input-wrapper">
                <input
                    type="password"
                    class="form-control"
                    id="{{ form.password1.id_for_label }}"
                    name="{{ form.password1.name }}"
                    placeholder="••••••••"
                    required
                    autocomplete="new-password"
                >
                {% trans "Mostrar senha" as aria_label_show_password %}
                <button
                    type="button"
                    class="password-toggle-btn"
                    aria-label="{{ aria_label_show_password }}"
                >
                    <i class="fa fa-eye"></i>
                </button>
            </div>
            {% if form.password1.errors %}
                <div class="text-danger small mt-2" style="line-height: 1.6;">
                    <ul class="mb-0 ps-3" style="list-style-type: none; padding-left: 0;">
                        {% for error in form.password1.errors %}
                        <li style="margin-bottom: 0.25rem;">
                            <i class="fa-solid fa-circle-exclamation" style="margin-right: 0.5rem;"></i>{{ error }}
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        </div>
        <div class="mb-3">
            <label for="{{ form.password2.id_for_label }}" class="form-label">{{ form.password2.label }}</label>
            <div class="password-input-wrapper">
                <input
                    type="password"
                    class="form-control"
                    id="{{ form.password2.id_for_label }}"
                    name="{{ form.password2.name }}"
                    placeholder="••••••••"
                    required
                    autocomplete="new-password"
                >
                {% trans "Mostrar senha" as aria_label_show_password2 %}
                <button
                    type="button"
                    class="password-toggle-btn"
                    aria-label="{{ aria_label_show_password2 }}"
                >
                    <i class="fa fa-eye"></i>
                </button>
            </div>
            {% if form.password2.errors %}
                <div class="text-danger small mt-2" style="line-height: 1.6;">
                    <ul class="mb-0 ps-3" style="list-style-type: none; padding-left: 0;">
                        {% for error in form.password2.errors %}
                        <li style="margin-bottom: 0.25rem;">
                            <i class="fa-solid fa-circle-exclamation" style="margin-right: 0.5rem;"></i>{{ error }}
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        </div>
        <button class="btn btn-primary" type="submit">{% trans "Atualizar senha" %}</button>
    </form>
{% endif %}
{% endblock %}
